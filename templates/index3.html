<!--
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Annexure Reports</title>
  <link rel="stylesheet" href="/static/styles.css">

  <style>
    body { font-family: Arial; margin: 30px; }
    table { width: 70%; border-collapse: collapse; }
    th, td { padding: 10px; border: 1px solid #ddd; text-align: center; }
    th { background: #f5f5f5; }
    button { padding: 8px 12px; border-radius: 6px; border: none; background: #007bff; color: #fff; cursor: pointer; }
    input[type=file] { margin-top: 8px; }
    .notice { color: green; }

    a.button-link {
      padding: 8px 12px;
      border-radius: 6px;
      background: #007bff;
      color: white;
      text-decoration: none;
      display: inline-block;
    }
  </style>
</head>

<body>
-->

<!-- Flash Messages -->
<!-- {% with msgs = get_flashed_messages(with_categories=true) %}
{% if msgs %}
  {% for category, msg in msgs %}
    <div style="color:red; font-weight:bold;">
      {{ msg }}
    </div>
  {% endfor %}
{% endif %}
{% endwith %}

<h2>PPN And Company</h2> -->

<!-- MAIN FILE UPLOAD for ANNEXURE 1–9 -->
<!-- <label><strong>Select Combined XLSX File:</strong></label><br>
<input id="mainFile" type="file" accept=".xls,.xlsx" required><br><br>

<table>
  <tr>
    <th>Annexure No.</th>
    <th>Description</th>
    <th>Download</th>
  </tr>

  {% for num, desc in [
      (8, 'Sale Value Less than LandedCost'),
      (9, 'Neither Profit Neither Loss'),
      (10, 'High Vendor Margin- Less Profit Margin'),
      
      
    ] %}
  <tr>
    <td>Annexure {{ num }}</td>
    <td>{{ desc }}</td>
    <td>
      <form id="form{{ num }}" action="/download/{{ num }}" method="POST" enctype="multipart/form-data">
        <input type="file" name="file" id="fileAnnex{{ num }}" style="display:none;">
        <button type="submit">Download</button>
      </form>
    </td>
  </tr>
  {% endfor %}

  

</table>

<p class="notice">Note: Upload a valid combined data Excel with required columns.</p>

<script> -->
<!-- Auto-copy file into Annexure 1–6 inputs -->
<!-- document.getElementById("mainFile").addEventListener("change", function () {
    let uploadedFile = this.files[0];

    function copyFile(targetInput) {
        let dt = new DataTransfer();
        dt.items.add(uploadedFile);
        targetInput.files = dt.files;
    }

    for (let i = 8; i <= 10; i++) {
        copyFile(document.getElementById("fileAnnex" + i));
    }
    


});
</script>

</body>
</html>  -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Annexure Reports</title>
  <link rel="stylesheet" href="/static/styles.css">

  <style>
    body { font-family: Arial; margin: 30px; }
    table { width: 70%; border-collapse: collapse; }
    th, td { padding: 10px; border: 1px solid #ddd; text-align: center; }
    th { background: #f5f5f5; }
    button { padding: 8px 12px; border-radius: 6px; border: none; background: #007bff; color: #fff; cursor: pointer; }
    input[type=file] { margin-top: 8px; }
    .notice { color: green; }

    a.button-link {
      padding: 8px 12px;
      border-radius: 6px;
      background: #007bff;
      color: white;
      text-decoration: none;
      display: inline-block;
    }
  </style>
</head>

<body>

<!-- Flash Messages -->
{% with msgs = get_flashed_messages(with_categories=true) %}
{% if msgs %}
  {% for category, msg in msgs %}
    <div style="color:red; font-weight:bold;">
      {{ msg }}
    </div>
  {% endfor %}
{% endif %}
{% endwith %}

<h2>PPN And Company</h2>

<!-- MAIN FILE UPLOAD for ANNEXURE 1–9 -->
<label><strong>Select Combined XLSX File:</strong></label><br>
<input id="mainFile" type="file" accept=".xls,.xlsx" required><br><br>

<table>
  <tr>
    <th>Annexure No.</th>
    <th>Description</th>
    <th>Action</th>
  </tr>

  {% for num, desc in [
      (8, 'Sale Value Less than LandedCost'),
      (9, 'Neither Profit Neither Loss'),
      (10, 'High Vendor Margin- Less Profit Margin'),
    ] %}
  <tr>
    <td>Annexure {{ num }}</td>
    <td>{{ desc }}</td>
    <td>
      <form id="form{{ num }}" action="/download/{{ num }}" method="POST" enctype="multipart/form-data">
        <input type="file" name="file" id="fileAnnex{{ num }}" style="display:none;">
        <button type="submit">Download</button>
      </form>
    </td>
  </tr>
  {% endfor %}

  <!-- NEW ANNEXURE 11 -->
  <tr>
    <td>Annexure 11</td>
    <td>Non Movement of Stock - Dept Wise</td>
    <td>
      <a class="button-link" href="/index4">Click Here</a>
    </td>
  </tr>

</table>

<p class="notice">Note: Upload a valid combined data Excel with required columns.</p>

<script>
// Auto-copy file into Annexure 8–10 inputs
document.getElementById("mainFile").addEventListener("change", function () {
    let uploadedFile = this.files[0];

    function copyFile(targetInput) {
        let dt = new DataTransfer();
        dt.items.add(uploadedFile);
        targetInput.files = dt.files;
    }

    for (let i = 8; i <= 10; i++) {
        copyFile(document.getElementById("fileAnnex" + i));
    }
});
</script>

</body>
</html>
